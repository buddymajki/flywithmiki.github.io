<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <title>FLYwithMIKI FlightDeck</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
   
		<link rel="icon" href="/favicon.ico" sizes="any">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="manifest" href="/site2.webmanifest">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	
	
    <style>
         body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background similar to the image */
            color: #e2e8f0;
            margin: 0;
            padding: 0;
        }
		
        .container {
            max-width: 400px;
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 1.5rem;
            background-color: #2d3748;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);

        }

    </style>
</head>



<body>


<div class="container">

	<form id="loginForm">
	<div id="" class="tab-content" style="display: flex; flex-direction: column; align-items: center;">
		<img src="https://flywithmiki.com/Images_v2/logo1.webp" class="w3-margin-bottom" alt="logoc" style="max-width:400px; margin:auto; width: 100%; filter: drop-shadow(7px 7px 7px white); display: block;">
		<H1>Flight Deck - Login</H1>
		
		<input class="w3-input w3-border w3-round" style="margin:auto; margin-top: 30px;" type="email" placeholder="Your email address" id="email" required>
		<input class="w3-input w3-border w3-round" style="margin:auto; margin-top: 30px;" type="password" placeholder="Your password" id="password" required>
		<button class="w3-button w3-round w3-margin-top" type="submit" style="margin:auto; background-color:#805ad5">Login</button>
		 <br> <button  class="w3-tiny" id="forgotBtn">Reset Password</button>
	</div>
	</form>




  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { 
      getAuth, signInWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged 
    } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

    // --- CONFIG: a te Firebase projekt configod ---
    const firebaseConfig = {
      apiKey: "AIzaSyCjSOM5roktee1TXbU6mrUhcMBe5Z-8ccY",
      authDomain: "flight-deck-3bb7b.firebaseapp.com",
      projectId: "flight-deck-3bb7b",
      storageBucket: "flight-deck-3bb7b.firebasestorage.app",
      messagingSenderId: "207195710488",
      appId: "1:207195710488:web:6f567ae11e680584214f6d",
      measurementId: "G-5D0JNV625P"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const loginForm = document.getElementById('loginForm');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const forgotEmailInput = document.getElementById('forgotEmail');
    const forgotBtn = document.getElementById('forgotBtn');

    function log(...args){
      console.log(...args);

    }

    // --- Login handler ---
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = emailInput.value;
      const password = passwordInput.value;
      if (!email || !password) { alert("Adj meg emailt és jelszót!"); return; }
      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        window.location.href = 'flightdeck_db.html'; // sikeres belépés
      } catch (err) {
        alert('Login error: ' + (err.message || err));
      }
    });

    // --- Password reset handler ---
    forgotBtn.addEventListener('click', async () => {
      const email = emailInput.value;
      if (!email) { alert("Please give your email to reset the password"); return; }
      try {
        await sendPasswordResetEmail(auth, email);
        alert("Password reset email sent.");
        log("Reset email sent to:", email);
      } catch (err) {
        alert("Error: " + (err.message || err));
      }
    });

    // --- Auto redirect, ha már be van jelentkezve ---
    onAuthStateChanged(auth, (user) => {
      if (user) {
        window.location.href = 'flightdeck_db.html';
      }
    });
  </script>


</body>
</html>
